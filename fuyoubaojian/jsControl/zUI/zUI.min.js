(function(a){a.zUI=a.zUI||{};a.zUI.emptyFn=function(){};a.zUI.asWidget=[];a.zUI.addWidget=function(e,d){a.zUI.asWidget.push(e);var c=a.zUI[e]=a.zUI[e]||{};var b="zUI"+e;c.sFlagName=b;c.sEventName=b+"Event";c.sOptsName=b+"Opts";c.__creator=a.zUI.emptyFn;c.__destroyer=a.zUI.emptyFn;a.extend(c,d);c.fn=function(h,g){var f=a(h);f.data(c.sOptsName,a.extend({},c.defaults,g));f.data(c.sFlagName,true);c.__creator(h);f.on(f.data(c.sEventName))};c.unfn=function(g){c.__destroyer(g);var f=a(g);if(f.data(c.sFlagName)){f.off(f.data(c.sEventName));f.data(c.sFlagName,false)}}};a.zUI.addWidget("draggable",{defaults:{bOffsetParentBoundary:false,oBoundary:null,fnComputePosition:null},__creator:function(c){var b=a(c);b.data(a.zUI.draggable.sEventName,{mousedown:function(j){var d=a(this);var i=d.data(a.zUI.draggable.sOptsName);d.trigger("draggable.start");var h=j.pageX-this.offsetLeft;var f=j.pageY-this.offsetTop;function e(n){var m={};if(i.fnComputePosition){m=i.fnComputePosition(n,h,f)}else{m.iLeft=n.pageX-h;m.iTop=n.pageY-f}var k=i.oBoundary;if(i.bOffsetParentBoundary){var l=d.offsetParent()[0];k={};k.iMinLeft=0;k.iMinTop=0;k.iMaxLeft=l.clientWidth-d.outerWidth();k.iMaxTop=l.clientHeight-d.outerHeight()}if(k){m.iLeft=m.iLeft<k.iMinLeft?k.iMinLeft:m.iLeft;m.iLeft=m.iLeft>k.iMaxLeft?k.iMaxLeft:m.iLeft;m.iTop=m.iTop<k.iMinTop?k.iMinTop:m.iTop;m.iTop=m.iTop>k.iMaxTop?k.iMaxTop:m.iTop}d.css({left:m.iLeft,top:m.iTop});d.find('[data-fixed="1"]').css({position:"absolute",top:Math.abs(m.iTop)+"px"});d.find('[data-fixed="0"]').css({position:"static"});if(typeof n.preventDefault!="undefined"){n.preventDefault()}else{n.returnValue=false}d.trigger("draggable.move")}var g={mousemove:e,mouseup:function(){a(document).off(g);d.trigger("draggable.stop")}};a(document).on(g)}})}});a.zUI.addWidget("panel",{defaults:{iWheelStep:16,sBoxClassName:"zUIpanelScrollBox",sBarClassName:"zUIpanelScrollBar",wBoxClassName:"zUIpanelScrollBoxW",wBarClassName:"zUIpanelScrollBoxWBar"},__creator:function(o){var l=a(o);if(l.css("position")==="static"){l.css("position","relative")}l.css("overflow","hidden");var d=l.children(":first");if(d.length){d.css({top:0,position:"absolute",left:0,overflow:"hidden"})}else{return}function p(q,r){if(!r){var r=[]}r.push(q);if(q&&q.parentNode){p(q.parentNode,r)}return r}var b=l.data(a.zUI.panel.sOptsName);var k=a("<div style='position:absolute;display:none;line-height:0;font-size: 0;'> A</div>");k.addClass(b.sBoxClassName);var n=a("<div style='position:absolute;display:none;line-height:0;font-size: 0;'> A</div>");n.addClass(b.sBarClassName);k.appendTo(l);n.appendTo(l);var g=a("<div style='position:absolute;display:none;line-height:0;font-size: 0;'> A</div>");g.addClass(b.wBoxClassName);var j=a("<div style='position:absolute;display:none;line-height:0;font-size: 0;'> A</div>");j.addClass(b.wBarClassName);g.appendTo(l);j.appendTo(g);b.iTop=parseInt(k.css("top"));b.iWidth=n.width();b.iRight=parseInt(k.css("right"));b.iLeft=parseInt(k.css("left"));n.on("draggable.move",function(){var q=l.data(a.zUI.panel.sOptsName);f(k,n,l,d,q.iTop,0);o.scrollIng&&o.scrollIng(o);q.scrollIng&&q.scrollIng(o)});function e(t,s){var u=p(t);var q=0;for(var r=0;r<u.length;r++){if(u[r]==s){return q}else{if(r==0){q=q+a(u[r]).position().top}else{if((a(u[r]).css("position")=="position"||a(u[r]).css("position")=="relative")){q=q+a(u[r]).position().top}}}}}a.each(l,function(){var q=this;a(q).on("focus","[type='text'],textarea",function(s){var r=a(q).children(":first").height()-a(q).height();if(r<0){return}if(-e(this,q)<parseInt(a(q).children(":first").css("top"))-a(q).height()){if(e(this,q)>r){a(q).children(":first").css({top:-r+"px"})}else{a(q).children(":first").css({top:-e(this,q)+"px"})}}})});l.on("scroll",function(){for(var q=-0;q<l.length;q++){if(l[q].scrollTop==0){return}l[q].scrollTop=0}});j.on("draggable.move",function(){if(g.css("display")=="none"){a(this).css({top:"0"});return}var r=Math.round(parseFloat(a(this).css("left")));var q=a(this.parentNode).width();d.css({left:-Math.round(r/q*d.width())+"px"});o.scrollWIng&&o.scrollWIng(o);b.scrollWIng&&b.scrollWIng(o)});if(typeof b.scrollWResize!="undefined"&&b.scrollWResize==1){a(window).on("resize",function(){d.css({left:"0px"});j.css({left:"0px"});o.scrollWIng&&o.scrollWIng(o);b.scrollWIng&&b.scrollWIng(o)})}var m={mouseenter:function(){if(typeof b.vScroll=="undefined"){i();k.css("display","block");n.css("display","block")}if(typeof b.cScroll=="undefined"){c();j.css("display","block");g.css("display","block")}},mouseleave:function(){k.css("display","none");n.css("display","none");j.css("display","none");g.css("display","none")}};if(typeof b.mousemoveType!="undefined"&&b.mousemoveType==true){m.mousemove=function(){if(typeof b.vScroll=="undefined"){i();k.css("display","block");n.css("display","block")}if(typeof b.cScroll=="undefined"){c();j.css("display","block");g.css("display","block")}}}var h="mousewheel";if(!("onmousewheel" in document)){h="DOMMouseScroll"}m[h]=function(s){var r=l.data(a.zUI.panel.sOptsName);
if(typeof r.vScroll!="undefined"){return}var q=1;s=s.originalEvent;if(s.wheelDelta){q=s.wheelDelta/120}else{q=-s.detail/3}var u=l.innerHeight()-d.outerHeight();if(u>0){d.css("top",0);return}var t=parseInt(d.css("top"));t=t+r.iWheelStep*q;if(t>0){t=0}if(t<u){t=u}if(!(t<=u||t>=0)){if(typeof s.preventDefault!="undefined"){s.preventDefault()}else{s.returnValue=false}s.stopPropagation()}d.css("top",t);f(l,d,k,n,0,r.iTop);d.find('[data-fixed="1"]').css({position:"absolute",top:Math.abs(t)+"px"});d.find('[data-fixed="0"]').css({position:"static"});o.scrollIng&&o.scrollIng(o);r.scrollIng&&r.scrollIng(o)};l.data(a.zUI.panel.sEventName,m);function f(u,w,s,r,y,x){var q=l.data(a.zUI.panel.sOptsName);var v=(parseInt(w.css("top"))-y)/(w.outerHeight()-u.innerHeight());var t=(r.outerHeight()-s.innerHeight())*v+x;r.css("top",t)}function c(){var s=l.innerWidth()/d.outerWidth();var r=Math.round(s*l.innerWidth());var q=l.innerWidth();if(s>=1){g.css("width",0);j.css("width",0);return}g.css("width",q);j.css("width",r);j.draggable({bOffsetParentBoundary:true})}function i(){var u=l.data(a.zUI.panel.sOptsName);var r=l.innerHeight()-2*u.iTop;var t=l.innerHeight()/d.outerHeight();var s=s=Math.round(t*r);if(t>=1){k.css("height",0);n.css("height",0);return}k.css("height",r);n.css("height",s);var q={iMinTop:u.iTop};q.iMaxTop=r-Math.round(t*r)+u.iTop;q.iMinLeft=l.innerWidth()-u.iWidth-u.iRight;q.iMaxLeft=q.iMinLeft;f(l,d,k,n,0,u.iTop);n.draggable({oBoundary:q})}},__destroyer:function(d){var b=a(d);if(b.data(a.zUI.panel.sFlagName)){var c=b.data(a.zUI.panel.sOptsName);b.children("."+c.sBoxClassName).remove();b.children("."+c.sBarClassName).remove()}}});a.each(a.zUI.asWidget,function(c,d){unWidget="un"+d;var b={};b[d]=function(e){this.each(function(){a.zUI[d].fn(this,e)});return this};b[unWidget]=function(){this.each(function(){a.zUI[d].unfn(this)});return this};a.fn.extend(b)})})(jQuery);